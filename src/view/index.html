<!--
    {[]Research}
-->
{{ block "index" . }}
<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>Bulle-blioth√®que</title>
    <script src="https://unpkg.com/htmx.org@1.9.11" integrity="sha384-0gxUXCCR8yv9FM2b+U3FDbsKthCI66oH5IA9fHppQq9DDMHuMauqq1ZHBpJxQ0J0" crossorigin="anonymous"></script>
</head>
<body>

<div class="header">
    <!--HEADER HERE-->
    <label>
        <input type="text" name="q" class="search-box"
            hx-trigger="keyup changed delay:0.4s"
            hx-get="/browse"
            hx-include="this"
            hx-target=".main-body"
            hx-swap="innerHTML">
    </label>
</div>

{{template "main-body" .}}

</body>
</html>
{{end}}

<!--
{[]Research}
-->
{{block "main-body" .}}
    <div class="main-body">
        <!--RESEARCH CONTAINERS HERE-->
        {{range .}}
            {{template "research-container" .}}
        {{end}}
    </div>
{{end}}

<!--
{Name, IsInfinite, BookPreviewSet, InfiniteBookPreviewSet}
-->
{{block "research-container" .}}
    <div class="research-container">
        <div class="research-name">

            <!--RESEARCH NAME HERE-->
            {{.Name}}

        </div>
        <div class="book-container">

            <!--BOOK TEMPLATES HERE-->
            {{if .IsInfinite}}
                {{template "infinite-book-set" .InfiniteBookPreviewSet}}
            {{else}}
                {{template "book-set" .BookPreviewSet}}
            {{end}}

        </div>
    </div>
{{end}}

<!--
    {[]BookPreview}
-->
{{block "book-set" .}}
    {{range .}}
        {{template "book-preview" .}}
    {{end}}
{{end}}


<!--
    {BookPreviewSet, Url, Params}
-->
{{block "infinite-book-set" .}}
    <!--BOOK TEMPLATES HERE-->
    {{template "book-set" .BookPreviewSet}}
    <!--INFINITE SEARCH HERE-->
    <div
        hx-swap="outerHTML"
        hx-trigger="revealed"
        hx-get="{{.Url}}"
        hx-vals='{ {{range .Params}}"{{.Key}}": "{{.Value}}", {{end}} "": ""}'>
    </div>
{{end}}

<!--
    {Id, Cover, Title}
-->
{{block "book-preview" .}}
    <a href="book/{{.Id}}">
        <div class="book-template">
            <div class="book-image">

                <!--BOOK IMAGE HERE-->
                <img src="{{.Cover}}" alt="book">

            </div>
            <div class="book-title">

                <!--BOOK TITLE HERE-->
                {{.Title}}

            </div>
        </div>
    </a>
{{end}}